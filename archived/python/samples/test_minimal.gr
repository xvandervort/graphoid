#!/usr/bin/env glang

# Minimal test to isolate parsing issues

print("Testing lambda functionality directly...")

# Test basic lambda support
numbers = [1, 2, 3, 4, 5]
double_func = x => x * 2

print("Original numbers: " + numbers.to_string())

doubled = numbers.map(double_func)
print("Doubled with lambda: " + doubled.to_string())

# Test lambda with filter
even_func = x => (x % 2) == 0
evens = numbers.filter(even_func)
print("Evens with lambda: " + evens.to_string())

print("✅ Lambda functionality works perfectly!")

# Now let's test basic DataFrame without loading the file
print("\n--- Testing DataFrame creation manually ---")

# Create simple DataFrame structure manually
df = {
    "_type": "dataframe",
    "_columns": ["name", "age"],
    "_data": [],
    "_row_count": 0
}

# Initialize empty columns
df["name"] = []
df["age"] = []

print("Created DataFrame structure: " + df["_columns"].to_string())

# Add some data
df["name"].append("Alice")
df["age"].append(30)
df["_row_count"] = 1

print("Added row - Name column: " + df["name"].to_string())
print("Added row - Age column: " + df["age"].to_string())

print("✅ Basic DataFrame structure works!")

print("\n--- Testing Enhanced DataFrame Functions Directly ---")