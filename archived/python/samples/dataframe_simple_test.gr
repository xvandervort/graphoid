#!/usr/bin/env glang

# Simple DataFrame test using variable keys directly

print("=== Simple DataFrame Test ===")

# Create DataFrame structure using variable keys
name_col = "name"
age_col = "age"
dept_col = "department"

# Create basic DataFrame structure
employee = {
    "_type": "dataframe",
    "_columns": [name_col, age_col, dept_col],
    "_row_count": 0
}

# Initialize columns using variable keys - THIS IS THE KEY IMPROVEMENT!
employee[name_col] = []
employee[age_col] = []
employee[dept_col] = []

print("DataFrame structure created with variable column names")

# Add data using variable keys in map literals - THE MAJOR IMPROVEMENT!
emp1 = { name_col: "Alice", age_col: 30, dept_col: "Engineering" }
emp2 = { name_col: "Bob", age_col: 25, dept_col: "Sales" }

# Add the data to columns
employee[name_col].append(emp1[name_col])
employee[age_col].append(emp1[age_col])
employee[dept_col].append(emp1[dept_col])
employee["_row_count"] = employee["_row_count"] + 1

employee[name_col].append(emp2[name_col])
employee[age_col].append(emp2[age_col])
employee[dept_col].append(emp2[dept_col])
employee["_row_count"] = employee["_row_count"] + 1

print("Added 2 employees using clean variable key syntax")
print("Names: " + employee["name"].to_string())
print("Ages: " + employee["age"].to_string())
print("Departments: " + employee["department"].to_string())
print("Row count: " + employee["_row_count"].to_string())

print("âœ… Variable keys enable much cleaner DataFrame construction!")